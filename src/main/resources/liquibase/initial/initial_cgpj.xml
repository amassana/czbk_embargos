<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">

    <changeSet author="aniol.massana (generated)" id="1611851242566-37">
        <createTable remarks="Tabla Base para almacenar el estado interno de una solicitud de cancelación del CGPJ." tableName="ESTADO_INT_CANCELACION">
            <column name="COD_ESTADO_INT_CANCELACION" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_INT_CANCELACION_PK"/>
            </column>
            <column name="DES_ESTADO_INT_CANCELACION" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-38">
        <createTable remarks="Tabla Base para almacenar el estado interno de una solicitud de ejecución del CGPJ." tableName="ESTADO_INT_EJECUCION">
            <column name="COD_ESTADO_INT_EJECUCION" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_INT_EJECUCION_PK"/>
            </column>
            <column name="DES_ESTADO_INT_EJECUCION" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-39">
        <createTable remarks="Tabla Base para almacenar el estado interno de una solicitud de levantamiento del CGPJ." tableName="ESTADO_INT_LEVANTAMIENTO">
            <column name="COD_ESTADO_INT_LEVANTAMIENTO" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_INT_LEVANTAMIENTO_PK"/>
            </column>
            <column name="DES_ESTADO_INT_LEVANTAMIENTO" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-40">
        <createTable remarks="Tabla Base para almacenar el estado interno de un fichero de peticiones." tableName="ESTADO_INT_PETICION">
            <column name="COD_ESTADO_INT_PETICION" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_INTERNO_PETICION_PK"/>
            </column>
            <column name="DES_ESTADO_INT_PETICION" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-41">
        <createTable remarks="Tabla Base para almacenar el estado interno de una solicitud de traba del CGPJ." tableName="ESTADO_INT_TRABA">
            <column name="COD_ESTADO_INT_TRABA" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_INT_TRABA_PK"/>
            </column>
            <column name="DES_ESTADO_INT_TRABA" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-44">
        <createTable remarks="Tabla base para los estados de envío que manda el CGPJ a la Entidad Financiera." tableName="ESTADO_PRIMARIO_PETICION">
            <column name="COD_ESTADO_PRIMARIO_PETICION" type="VARCHAR2(4 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_PRIMARIO_PETICION_PK"/>
            </column>
            <column name="DES_ESTADO_PRIMARIO_PETICION" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-45">
        <createTable remarks="Tabla base para los estados de las respuestas que manda la Entidad Financiera al CGPJ." tableName="ESTADO_PRIMARIO_RESP">
            <column name="COD_ESTADO_PRIMARIO_RESP" type="VARCHAR2(4 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_PRIMARIO_RESP_PK"/>
            </column>
            <column name="DES_ESTADO_PRIMARIO_RESP" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-46">
        <createTable remarks="Tabla con las posibles respuestas a las solicitudes de ejecución." tableName="ESTADO_RESP_EJECUCION">
            <column name="COD_ESTADO_RESP_EJECUCION" type="VARCHAR2(4 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_RESP_EJECUCION_PK"/>
            </column>
            <column name="DES_ESTADO_RESP_EJECUCION" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-47">
        <createTable remarks="Tabla con las posibles respuestas a las solicitudes de levantamiento." tableName="ESTADO_RESP_LEVANTAMIENTO">
            <column name="COD_ESTADO_RESP_LEVANTAMIENTO" type="VARCHAR2(4 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_RESP_LEVANTAMIENTO_PK"/>
            </column>
            <column name="DES_ESTADO_RESP_LEVANTAMIENTO" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-48">
        <createTable remarks="Tabla con las posibles respuestas a las peticiones de traba." tableName="ESTADO_RESP_TRABA">
            <column name="COD_ESTADO_RESP_TRABA" type="VARCHAR2(4 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_RESP_TRABA_PK"/>
            </column>
            <column name="DES_ESTADO_RESP_TRABA" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-50">
        <createTable remarks="Tabla base para los estados secundarios de las respuestas que manda la Entidad Financiera al CGPJ." tableName="ESTADO_SECUNDARIO_RESP">
            <column name="COD_ESTADO_SECUNDARIO_RESP" type="VARCHAR2(16 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="ESTADO_SECUNDARIO_RESP_PK"/>
            </column>
            <column name="DES_ESTADO_SECUNDARIO_RESP" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-79">
        <createTable remarks="Tabla con las posibles tipos de documento para identificar a un cliente." tableName="TIPO_DOCUMENTACION">
            <column name="COD_TIPO_DOCUMENTACION" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="TIPO_DOCUMENTACION_PK"/>
            </column>
            <column name="DES_TIPO_DOCUMENTACION" type="VARCHAR2(60 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-52">
        <createTable tableName="FESTIVO">
            <column name="COD_FESTIVO" type="NUMBER"/>
            <column name="COD_LOCALIDAD" type="NUMBER"/>
            <column name="F_FESTIVO" type="NUMBER"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER"/>
            <column name="DES_FESTIVO" type="VARCHAR2(25 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-77">
        <createTable tableName="TAREAS_PENDIENTES">
            <column name="COD_TAREA_PENDIENTE" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_TAREAS_PENDIENTES"/>
            </column>
            <column name="DESCRIPCION" type="VARCHAR2(200 CHAR)"/>
            <column name="FECHA_TOPE_REALIZACION" type="NUMBER(14, 0)"/>
            <column name="FECHA_INICIO_AVISO" type="NUMBER(14, 0)"/>
            <column name="FECHA_EFECTIVA_REALIZACION" type="NUMBER(14, 0)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="COD_SUCURSAL" type="NUMBER"/>
            <column name="COD_CONTROL_FICHERO" type="NUMBER"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-78">
        <createTable tableName="TAREAS_REALIZADAS">
            <column name="COD_TAREA_REALIZADA" type="NUMBER">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PK_TAREAS_REALIZADAS"/>
            </column>
            <column name="FECHA_TOPE_REALIZACION" type="NUMBER(14, 0)"/>
            <column name="FECHA_EFECTIVA_REALIZACION" type="NUMBER(14, 0)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="FECHA_INICIO_AVISO" type="NUMBER(14, 0)"/>
            <column name="DESCRIPCION" type="VARCHAR2(200 CHAR)"/>
            <column name="COD_SUCURSAL" type="NUMBER"/>
            <column name="COD_CONTROL_FICHERO" type="NUMBER"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-71">
    <createTable tableName="SEMAFORO">
        <column name="FECHA" type="NUMBER(14, 0)"/>
        <column name="USUARIO" type="VARCHAR2(25 CHAR)"/>
        <column name="MAQUINA" type="VARCHAR2(25 CHAR)"/>
    </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-72">
        <createTable tableName="SEMAFORO_CGPJ">
            <column name="FECHA" type="NUMBER(14, 0)">
                <constraints nullable="false"/>
            </column>
            <column name="USUARIO" type="NVARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
            <column name="MAQUINA" type="NVARCHAR2(50)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-73">
        <createTable tableName="SOLICITUDES_CANCELACION">
            <column name="COD_SOLICITUD_CANCELACION" type="VARCHAR2(40 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="SOLICITUDES_CANCELACION_PK"/>
            </column>
            <column name="COD_PETICION" type="VARCHAR2(16 CHAR)"/>
            <column name="COD_ESTADO_INT_CANCELACION" type="NUMBER"/>
            <column name="NIF_EMISOR" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_EMISOR" type="VARCHAR2(50 CHAR)"/>
            <column name="IDENTIFICADOR_SOLICITANTE" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_SOLICITANTE" type="VARCHAR2(50 CHAR)"/>
            <column name="FINALIDAD" type="VARCHAR2(250 CHAR)"/>
            <column name="CONSENTIMIENTO" type="VARCHAR2(20 CHAR)"/>
            <column name="NOMBRE_COMPLETO_FUNCIONARIO" type="VARCHAR2(122 CHAR)"/>
            <column name="NIF_FUNCIONARIO" type="VARCHAR2(10 CHAR)"/>
            <column name="COD_TIPO_DOCUMENTACION" type="NUMBER"/>
            <column name="DOCUMENTACION" type="VARCHAR2(14 CHAR)"/>
            <column name="NOMBRE_COMPLETO_TITULAR" type="VARCHAR2(122 CHAR)"/>
            <column name="NOMBRE_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO1_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO2_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="CODIGO_CERTIFICADO" type="VARCHAR2(64 CHAR)"/>
            <column name="ID_TRANSMISION" type="VARCHAR2(26 CHAR)"/>
            <column name="FECHA_GENERACION" type="VARCHAR2(29 CHAR)"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
            <column name="COD_SOLICITUD_A_CANCELAR" type="VARCHAR2(40 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-74">
        <createTable tableName="SOLICITUDES_EJECUCION">
            <column name="COD_SOLICITUD_EJECUCION" type="VARCHAR2(40 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="SOLICITUDES_EJECUCION_PK"/>
            </column>
            <column name="COD_PETICION" type="VARCHAR2(16 CHAR)"/>
            <column name="COD_TRABA" type="NUMBER"/>
            <column name="COD_ESTADO_INT_EJECUCION" type="NUMBER"/>
            <column name="COD_ESTADO_RESP_EJECUCION" type="VARCHAR2(4 CHAR)"/>
            <column name="ORDENANTE" type="VARCHAR2(70 CHAR)"/>
            <column name="ID_ORDENANTE" type="VARCHAR2(14 CHAR)"/>
            <column name="IBAN" type="VARCHAR2(24 CHAR)"/>
            <column name="CONCEPTO" type="VARCHAR2(140 CHAR)"/>
            <column name="BENEFICIARIO" type="VARCHAR2(70 CHAR)"/>
            <column name="BIC" type="VARCHAR2(11 CHAR)"/>
            <column name="TIPOTR" type="VARCHAR2(4 CHAR)"/>
            <column name="PROPOSITOTR" type="VARCHAR2(4 CHAR)"/>
            <column name="IMPORTE_SOLICITUD" type="VARCHAR2(13 CHAR)"/>
            <column name="IMPORTE_RESPUESTA" type="VARCHAR2(13 CHAR)"/>
            <column name="NIF_EMISOR" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_EMISOR" type="VARCHAR2(50 CHAR)"/>
            <column name="IDENTIFICADOR_SOLICITANTE" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_SOLICITANTE" type="VARCHAR2(50 CHAR)"/>
            <column name="FINALIDAD" type="VARCHAR2(250 CHAR)"/>
            <column name="CONSENTIMIENTO" type="VARCHAR2(20 CHAR)"/>
            <column name="NOMBRE_COMPLETO_FUNCIONARIO" type="VARCHAR2(122 CHAR)"/>
            <column name="NIF_FUNCIONARIO" type="VARCHAR2(10 CHAR)"/>
            <column name="COD_TIPO_DOCUMENTACION" type="NUMBER"/>
            <column name="DOCUMENTACION" type="VARCHAR2(14 CHAR)"/>
            <column name="NOMBRE_COMPLETO_TITULAR" type="VARCHAR2(122 CHAR)"/>
            <column name="NOMBRE_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO1_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO2_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="CODIGO_CERTIFICADO" type="VARCHAR2(64 CHAR)"/>
            <column name="ID_TRANSMISION" type="VARCHAR2(26 CHAR)"/>
            <column name="FECHA_GENERACION" type="VARCHAR2(29 CHAR)"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-75">
        <createTable tableName="SOLICITUDES_LEVANTAMIENTO">
            <column name="COD_SOLICITUD_LEVANTAMIENTO" type="VARCHAR2(40 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="SOLICITUDES_LEVANTAMIENTO_PK"/>
            </column>
            <column name="COD_PETICION" type="VARCHAR2(16 CHAR)"/>
            <column name="COD_TRABA" type="NUMBER"/>
            <column name="COD_ESTADO_INT_LEVANTAMIENTO" type="NUMBER"/>
            <column name="COD_ESTADO_RESP_LEVANTAMIENTO" type="VARCHAR2(4 CHAR)"/>
            <column name="IMPORTE_SOLICITUD" type="VARCHAR2(13 CHAR)"/>
            <column name="IMPORTE_RESPUESTA" type="VARCHAR2(13 CHAR)"/>
            <column name="NIF_EMISOR" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_EMISOR" type="VARCHAR2(50 CHAR)"/>
            <column name="IDENTIFICADOR_SOLICITANTE" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_SOLICITANTE" type="VARCHAR2(50 CHAR)"/>
            <column name="FINALIDAD" type="VARCHAR2(250 CHAR)"/>
            <column name="CONSENTIMIENTO" type="VARCHAR2(20 CHAR)"/>
            <column name="NOMBRE_COMPLETO_FUNCIONARIO" type="VARCHAR2(122 CHAR)"/>
            <column name="NIF_FUNCIONARIO" type="VARCHAR2(10 CHAR)"/>
            <column name="COD_TIPO_DOCUMENTACION" type="NUMBER"/>
            <column name="DOCUMENTACION" type="VARCHAR2(14 CHAR)"/>
            <column name="NOMBRE_COMPLETO_TITULAR" type="VARCHAR2(122 CHAR)"/>
            <column name="NOMBRE_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO1_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO2_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="CODIGO_CERTIFICADO" type="VARCHAR2(64 CHAR)"/>
            <column name="ID_TRANSMISION" type="VARCHAR2(26 CHAR)"/>
            <column name="FECHA_GENERACION" type="VARCHAR2(29 CHAR)"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
            <column defaultValue="N" name="INTERVENCION_USUARIO" type="VARCHAR2(1 CHAR)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-76">
        <createTable tableName="SOLICITUDES_TRABA">
            <column name="COD_SOLICITUD_TRABA" type="VARCHAR2(40 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="SOLICITUDES_TRABA_PK"/>
            </column>
            <column name="COD_PETICION" type="VARCHAR2(16 CHAR)"/>
            <column name="COD_TRABA" type="NUMBER"/>
            <column name="COD_ESTADO_INT_TRABA" type="NUMBER"/>
            <column name="COD_ESTADO_RESP_TRABA" type="VARCHAR2(4 CHAR)"/>
            <column name="IMPORTE_SOLICITUD" type="VARCHAR2(13 CHAR)"/>
            <column name="IMPORTE_RESPUESTA" type="VARCHAR2(13 CHAR)"/>
            <column name="TIENE_POSICIONES" type="VARCHAR2(1 CHAR)"/>
            <column name="NIF_EMISOR" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_EMISOR" type="VARCHAR2(50 CHAR)"/>
            <column name="IDENTIFICADOR_SOLICITANTE" type="VARCHAR2(10 CHAR)"/>
            <column name="NOMBRE_SOLICITANTE" type="VARCHAR2(50 CHAR)"/>
            <column name="FINALIDAD" type="VARCHAR2(250 CHAR)"/>
            <column name="CONSENTIMIENTO" type="VARCHAR2(20 CHAR)"/>
            <column name="NOMBRE_COMPLETO_FUNCIONARIO" type="VARCHAR2(122 CHAR)"/>
            <column name="NIF_FUNCIONARIO" type="VARCHAR2(10 CHAR)"/>
            <column name="COD_TIPO_DOCUMENTACION" type="NUMBER"/>
            <column name="DOCUMENTACION" type="VARCHAR2(14 CHAR)"/>
            <column name="NOMBRE_COMPLETO_TITULAR" type="VARCHAR2(122 CHAR)"/>
            <column name="NOMBRE_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO1_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="APELLIDO2_TITULAR" type="VARCHAR2(40 CHAR)"/>
            <column name="CODIGO_CERTIFICADO" type="VARCHAR2(64 CHAR)"/>
            <column name="ID_TRANSMISION" type="VARCHAR2(26 CHAR)"/>
            <column name="FECHA_GENERACION" type="VARCHAR2(29 CHAR)"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-56">
        <createTable tableName="PETICIONES">
            <column name="COD_PETICION" type="VARCHAR2(16 CHAR)">
                <constraints nullable="false" primaryKey="true" primaryKeyName="PETICIONES_PK"/>
            </column>
            <column name="NUM_ELEMENTOS" type="NUMBER"/>
            <column name="TIMESTAMP" type="VARCHAR2(29 CHAR)"/>
            <column name="COD_ESTADO_PRIMARIO_PETICION" type="VARCHAR2(4 CHAR)"/>
            <column name="COD_ESTADO_PRIMARIO_RESP" type="VARCHAR2(4 CHAR)"/>
            <column name="ESTADO_SECUNDARIO_PETICION" type="VARCHAR2(16 CHAR)"/>
            <column name="COD_ESTADO_SECUNDARIO_RESP" type="VARCHAR2(16 CHAR)"/>
            <column name="LITERAL_ERROR" type="VARCHAR2(255 CHAR)"/>
            <column name="TIEMPO_ESTIMADO_RESPUESTA" type="NUMBER"/>
            <column name="COD_CONTROL_FICHERO" type="NUMBER"/>
            <column name="COD_ESTADO_INT_PETICION" type="NUMBER"/>
            <column name="USUARIO_ULT_MODIFICACION" type="VARCHAR2(10 CHAR)"/>
            <column name="F_ULTIMA_MODIFICACION" type="NUMBER(14, 0)"/>
        </createTable>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-107">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_secundario_resp.csv" quotchar="&quot;" separator="," tableName="ESTADO_SECUNDARIO_RESP">
            <column header="COD_ESTADO_SECUNDARIO_RESP" name="COD_ESTADO_SECUNDARIO_RESP" type="STRING"/>
            <column header="DES_ESTADO_SECUNDARIO_RESP" name="DES_ESTADO_SECUNDARIO_RESP" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_SECUNDARIO_RESP"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-94">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_int_cancelacion.csv" quotchar="&quot;" separator="," tableName="ESTADO_INT_CANCELACION">
            <column header="COD_ESTADO_INT_CANCELACION" name="COD_ESTADO_INT_CANCELACION" type="NUMERIC"/>
            <column header="DES_ESTADO_INT_CANCELACION" name="DES_ESTADO_INT_CANCELACION" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_INT_CANCELACION"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-95">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_int_ejecucion.csv" quotchar="&quot;" separator="," tableName="ESTADO_INT_EJECUCION">
            <column header="COD_ESTADO_INT_EJECUCION" name="COD_ESTADO_INT_EJECUCION" type="NUMERIC"/>
            <column header="DES_ESTADO_INT_EJECUCION" name="DES_ESTADO_INT_EJECUCION" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_INT_EJECUCION"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-96">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_int_levantamiento.csv" quotchar="&quot;" separator="," tableName="ESTADO_INT_LEVANTAMIENTO">
            <column header="COD_ESTADO_INT_LEVANTAMIENTO" name="COD_ESTADO_INT_LEVANTAMIENTO" type="NUMERIC"/>
            <column header="DES_ESTADO_INT_LEVANTAMIENTO" name="DES_ESTADO_INT_LEVANTAMIENTO" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_INT_LEVANTAMIENTO"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-97">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_int_peticion.csv" quotchar="&quot;" separator="," tableName="ESTADO_INT_PETICION">
            <column header="COD_ESTADO_INT_PETICION" name="COD_ESTADO_INT_PETICION" type="NUMERIC"/>
            <column header="DES_ESTADO_INT_PETICION" name="DES_ESTADO_INT_PETICION" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_INT_PETICION"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-98">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_int_traba.csv" quotchar="&quot;" separator="," tableName="ESTADO_INT_TRABA">
            <column header="COD_ESTADO_INT_TRABA" name="COD_ESTADO_INT_TRABA" type="NUMERIC"/>
            <column header="DES_ESTADO_INT_TRABA" name="DES_ESTADO_INT_TRABA" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_INT_TRABA"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-101">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_primario_peticion.csv" quotchar="&quot;" separator="," tableName="ESTADO_PRIMARIO_PETICION">
            <column header="COD_ESTADO_PRIMARIO_PETICION" name="COD_ESTADO_PRIMARIO_PETICION" type="STRING"/>
            <column header="DES_ESTADO_PRIMARIO_PETICION" name="DES_ESTADO_PRIMARIO_PETICION" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_PRIMARIO_PETICION"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-102">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_primario_resp.csv" quotchar="&quot;" separator="," tableName="ESTADO_PRIMARIO_RESP">
            <column header="COD_ESTADO_PRIMARIO_RESP" name="COD_ESTADO_PRIMARIO_RESP" type="STRING"/>
            <column header="DES_ESTADO_PRIMARIO_RESP" name="DES_ESTADO_PRIMARIO_RESP" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_PRIMARIO_RESP"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-103">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_resp_ejecucion.csv" quotchar="&quot;" separator="," tableName="ESTADO_RESP_EJECUCION">
            <column header="COD_ESTADO_RESP_EJECUCION" name="COD_ESTADO_RESP_EJECUCION" type="STRING"/>
            <column header="DES_ESTADO_RESP_EJECUCION" name="DES_ESTADO_RESP_EJECUCION" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_RESP_EJECUCION"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-105">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_resp_traba.csv" quotchar="&quot;" separator="," tableName="ESTADO_RESP_TRABA">
            <column header="COD_ESTADO_RESP_TRABA" name="COD_ESTADO_RESP_TRABA" type="STRING"/>
            <column header="DES_ESTADO_RESP_TRABA" name="DES_ESTADO_RESP_TRABA" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_RESP_TRABA"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-104">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/estado_resp_levantamiento.csv" quotchar="&quot;" separator="," tableName="ESTADO_RESP_LEVANTAMIENTO">
            <column header="COD_ESTADO_RESP_LEVANTAMIENTO" name="COD_ESTADO_RESP_LEVANTAMIENTO" type="STRING"/>
            <column header="DES_ESTADO_RESP_LEVANTAMIENTO" name="DES_ESTADO_RESP_LEVANTAMIENTO" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="ESTADO_RESP_LEVANTAMIENTO"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-112">
        <loadData commentLineStartsWith="#" encoding="UTF-8" file="liquibase/initial/tipo_documentacion.csv" quotchar="&quot;" separator="," tableName="TIPO_DOCUMENTACION">
            <column header="COD_TIPO_DOCUMENTACION" name="COD_TIPO_DOCUMENTACION" type="NUMERIC"/>
            <column header="DES_TIPO_DOCUMENTACION" name="DES_TIPO_DOCUMENTACION" type="STRING"/>
        </loadData>
        <rollback>
            <delete tableName="TIPO_DOCUMENTACION"></delete>
        </rollback>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-15">
        <createSequence cacheSize="0" maxValue="9999999999999999999999999999" minValue="0" sequenceName="SEC_TAREAS_PENDIENTES" startValue="100000"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-231">
        <addForeignKeyConstraint baseColumnNames="COD_CONTROL_FICHERO" baseTableName="TAREAS_PENDIENTES" constraintName="TAREAS_PENDIE_FK31024906156205" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_CONTROL_FICHERO" referencedTableName="CONTROL_FICHERO" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-232">
        <addForeignKeyConstraint baseColumnNames="COD_CONTROL_FICHERO" baseTableName="TAREAS_REALIZADAS" constraintName="TAREAS_REALIZ_FK31024906174211" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_CONTROL_FICHERO" referencedTableName="CONTROL_FICHERO" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-215">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_INT_CANCELACION" baseTableName="SOLICITUDES_CANCELACION" constraintName="SOL_CANCELACION_ESTADO_INT_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_INT_CANCELACION" referencedTableName="ESTADO_INT_CANCELACION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-216">
        <addForeignKeyConstraint baseColumnNames="COD_PETICION" baseTableName="SOLICITUDES_CANCELACION" constraintName="SOL_CANCELACION_PETICION_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_PETICION" referencedTableName="PETICIONES" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-217">
        <addForeignKeyConstraint baseColumnNames="COD_TIPO_DOCUMENTACION" baseTableName="SOLICITUDES_CANCELACION" constraintName="SOL_CANCELACION_TIPO_DOC_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_TIPO_DOCUMENTACION" referencedTableName="TIPO_DOCUMENTACION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-218">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_INT_EJECUCION" baseTableName="SOLICITUDES_EJECUCION" constraintName="SOL_EJECUCION_ESTADO_INT_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_INT_EJECUCION" referencedTableName="ESTADO_INT_EJECUCION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-219">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_RESP_EJECUCION" baseTableName="SOLICITUDES_EJECUCION" constraintName="SOL_EJECUCION_ESTADO_RESP_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_RESP_EJECUCION" referencedTableName="ESTADO_RESP_EJECUCION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-220">
        <addForeignKeyConstraint baseColumnNames="COD_PETICION" baseTableName="SOLICITUDES_EJECUCION" constraintName="SOL_EJECUCION_PET_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_PETICION" referencedTableName="PETICIONES" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-221">
        <addForeignKeyConstraint baseColumnNames="COD_TIPO_DOCUMENTACION" baseTableName="SOLICITUDES_EJECUCION" constraintName="SOL_EJECUCION_TIPO_DOC_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_TIPO_DOCUMENTACION" referencedTableName="TIPO_DOCUMENTACION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-222">
        <addForeignKeyConstraint baseColumnNames="COD_PETICION" baseTableName="SOLICITUDES_LEVANTAMIENTO" constraintName="SOL_LEVANTAMIENTO_PETICION_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_PETICION" referencedTableName="PETICIONES" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-223">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_INT_LEVANTAMIENTO" baseTableName="SOLICITUDES_LEVANTAMIENTO" constraintName="SOL_LEVANT_ESTADO_INT_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_INT_LEVANTAMIENTO" referencedTableName="ESTADO_INT_LEVANTAMIENTO" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-224">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_RESP_LEVANTAMIENTO" baseTableName="SOLICITUDES_LEVANTAMIENTO" constraintName="SOL_LEVANT_ESTADO_RESP_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_RESP_LEVANTAMIENTO" referencedTableName="ESTADO_RESP_LEVANTAMIENTO" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-225">
        <addForeignKeyConstraint baseColumnNames="COD_TIPO_DOCUMENTACION" baseTableName="SOLICITUDES_LEVANTAMIENTO" constraintName="SOL_LEVANT_TIPO_DOC_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_TIPO_DOCUMENTACION" referencedTableName="TIPO_DOCUMENTACION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-226">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_INT_TRABA" baseTableName="SOLICITUDES_TRABA" constraintName="SOL_TRABA_ESTADO_INT_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_INT_TRABA" referencedTableName="ESTADO_INT_TRABA" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-227">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_RESP_TRABA" baseTableName="SOLICITUDES_TRABA" constraintName="SOL_TRABA_ESTADO_RESP_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_RESP_TRABA" referencedTableName="ESTADO_RESP_TRABA" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-228">
        <addForeignKeyConstraint baseColumnNames="COD_PETICION" baseTableName="SOLICITUDES_TRABA" constraintName="SOL_TRABA_PETICIONES_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_PETICION" referencedTableName="PETICIONES" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-229">
        <addForeignKeyConstraint baseColumnNames="COD_TIPO_DOCUMENTACION" baseTableName="SOLICITUDES_TRABA" constraintName="SOL_TRABA_TIPO_DOC_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_TIPO_DOCUMENTACION" referencedTableName="TIPO_DOCUMENTACION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-200">
        <addForeignKeyConstraint baseColumnNames="COD_CONTROL_FICHERO" baseTableName="PETICIONES" constraintName="PETICIONES_CONTROL_FICHERO_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_CONTROL_FICHERO" referencedTableName="CONTROL_FICHERO" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-201">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_INT_PETICION" baseTableName="PETICIONES" constraintName="PETICIONES_ESTADO_INT_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_INT_PETICION" referencedTableName="ESTADO_INT_PETICION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-202">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_PRIMARIO_PETICION" baseTableName="PETICIONES" constraintName="PETICIONES_ESTADO_PRIM_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_PRIMARIO_PETICION" referencedTableName="ESTADO_PRIMARIO_PETICION" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-203">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_PRIMARIO_RESP" baseTableName="PETICIONES" constraintName="PETICIONES_ESTADO_RESP_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_PRIMARIO_RESP" referencedTableName="ESTADO_PRIMARIO_RESP" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-204">
        <addForeignKeyConstraint baseColumnNames="COD_ESTADO_SECUNDARIO_RESP" baseTableName="PETICIONES" constraintName="PETICIONES_ESTADO_SEC_RESP_FK" deferrable="false" initiallyDeferred="false" onDelete="RESTRICT" onUpdate="RESTRICT" referencedColumnNames="COD_ESTADO_SECUNDARIO_RESP" referencedTableName="ESTADO_SECUNDARIO_RESP" validate="false"/>
    </changeSet>
    <changeSet author="aniol.massana (generated)" id="1611851242566-233">
        <createView fullDefinition="true" viewName="SOLICITUDES_CGPJ">CREATE OR REPLACE FORCE VIEW "SOLICITUDES_CGPJ" ("COD_CONTROL_FICHERO", "COD_PETICION", "ESTADO_INT_PETICION", "ESTADO_PRIMARIO_PETICION", "RELACION_FRAGMENTOS", "ESTADO_PRIMARIO_RESP", "ESTADO_SECUNDARIO_RESP", "TIPO_SOLICITUD", "ESTADO_INTERNO", "ESTADO_RESPUESTA", "DES_ENTIDAD", "TIPO_DOC", "DOCUMENTACION", "NOMBRE_TITULAR", "COD_SOLICITUD", "IMPORTE_SOLICITUD", "IMPORTE_RESPUESTA", "FECHA_GENERACION") AS SELECT PETICIONES.COD_CONTROL_FICHERO,PETICIONES.COD_PETICION,DES_ESTADO_INT_PETICION,PETICIONES.COD_ESTADO_PRIMARIO_PETICION || '-' || DES_ESTADO_PRIMARIO_PETICION,ESTADO_SECUNDARIO_PETICION,PETICIONES.COD_ESTADO_PRIMARIO_RESP || '-' || DES_ESTADO_PRIMARIO_RESP,PETICIONES.COD_ESTADO_SECUNDARIO_RESP || '-' || DES_ESTADO_SECUNDARIO_RESP,
            'TRABA' TS,DES_ESTADO_INT_TRABA,ESTADO_RESP_TRABA.COD_ESTADO_RESP_TRABA || '-' || DES_ESTADO_RESP_TRABA,ENTIDADES_ORDENANTES.DES_ENTIDAD,
            DES_TIPO_DOCUMENTACION,DOCUMENTACION,NOMBRE_COMPLETO_TITULAR,
            SOLICITUDES_TRABA.COD_SOLICITUD_TRABA COD_SOLICITUD,
            SOLICITUDES_TRABA.IMPORTE_SOLICITUD,
            SOLICITUDES_TRABA.IMPORTE_RESPUESTA,
            EMBARGO.FECHA_GENERACION
            FROM SOLICITUDES_TRABA,
            PETICIONES,
            EMBARGO,
            TRABAS,
            ENTIDADES_ORDENANTES,
            ESTADO_INT_TRABA,
            ESTADO_RESP_TRABA,
            TIPO_DOCUMENTACION,
            ESTADO_INT_PETICION,
            ESTADO_PRIMARIO_PETICION,
            ESTADO_PRIMARIO_RESP,
            ESTADO_SECUNDARIO_RESP
            WHERE PETICIONES.COD_PETICION    =SOLICITUDES_TRABA.COD_PETICION
            AND EMBARGO.COD_EMBARGO          =TRABAS.COD_EMBARGO
            AND TRABAS.COD_TRABA             =SOLICITUDES_TRABA.COD_TRABA
            AND EMBARGO.COD_ENTIDAD_ORDENANTE=ENTIDADES_ORDENANTES.COD_ENTIDAD_ORDENANTE
            AND SOLICITUDES_TRABA.COD_ESTADO_INT_TRABA=ESTADO_INT_TRABA.COD_ESTADO_INT_TRABA
            AND SOLICITUDES_TRABA.COD_ESTADO_RESP_TRABA=ESTADO_RESP_TRABA.COD_ESTADO_RESP_TRABA(+)
            AND SOLICITUDES_TRABA.COD_TIPO_DOCUMENTACION=TIPO_DOCUMENTACION.COD_TIPO_DOCUMENTACION
            AND PETICIONES.COD_ESTADO_INT_PETICION=ESTADO_INT_PETICION.COD_ESTADO_INT_PETICION
            AND PETICIONES.COD_ESTADO_PRIMARIO_PETICION=ESTADO_PRIMARIO_PETICION.COD_ESTADO_PRIMARIO_PETICION
            AND PETICIONES.COD_ESTADO_PRIMARIO_RESP=ESTADO_PRIMARIO_RESP.COD_ESTADO_PRIMARIO_RESP(+)
            AND PETICIONES.COD_ESTADO_SECUNDARIO_RESP=ESTADO_SECUNDARIO_RESP.COD_ESTADO_SECUNDARIO_RESP(+)
            UNION
            SELECT PETICIONES.COD_CONTROL_FICHERO,PETICIONES.COD_PETICION,DES_ESTADO_INT_PETICION,PETICIONES.COD_ESTADO_PRIMARIO_PETICION || '-' || DES_ESTADO_PRIMARIO_PETICION,ESTADO_SECUNDARIO_PETICION,PETICIONES.COD_ESTADO_PRIMARIO_RESP || '-' || DES_ESTADO_PRIMARIO_RESP,PETICIONES.COD_ESTADO_SECUNDARIO_RESP || '-' || DES_ESTADO_SECUNDARIO_RESP,
            'LEVANTAMIENTO' TS,DES_ESTADO_INT_LEVANTAMIENTO,ESTADO_RESP_LEVANTAMIENTO.COD_ESTADO_RESP_LEVANTAMIENTO || '-' || DES_ESTADO_RESP_LEVANTAMIENTO,ENTIDADES_ORDENANTES.DES_ENTIDAD,
            DES_TIPO_DOCUMENTACION,DOCUMENTACION,NOMBRE_COMPLETO_TITULAR,
            SOLICITUDES_LEVANTAMIENTO.COD_SOLICITUD_LEVANTAMIENTO,
            SOLICITUDES_LEVANTAMIENTO.IMPORTE_SOLICITUD,
            SOLICITUDES_LEVANTAMIENTO.IMPORTE_RESPUESTA,
            EMBARGO.FECHA_GENERACION
            FROM SOLICITUDES_LEVANTAMIENTO ,
            PETICIONES ,
            EMBARGO,
            TRABAS ,
            ENTIDADES_ORDENANTES,
            ESTADO_INT_LEVANTAMIENTO,
            ESTADO_RESP_LEVANTAMIENTO,
            TIPO_DOCUMENTACION,
            ESTADO_INT_PETICION,
            ESTADO_PRIMARIO_PETICION,
            ESTADO_PRIMARIO_RESP,
            ESTADO_SECUNDARIO_RESP
            WHERE PETICIONES.COD_PETICION    =SOLICITUDES_LEVANTAMIENTO.COD_PETICION
            AND EMBARGO.COD_EMBARGO          =TRABAS.COD_EMBARGO
            AND TRABAS.COD_TRABA             =SOLICITUDES_LEVANTAMIENTO.COD_TRABA
            AND EMBARGO.COD_ENTIDAD_ORDENANTE=ENTIDADES_ORDENANTES.COD_ENTIDAD_ORDENANTE
            AND SOLICITUDES_LEVANTAMIENTO.COD_ESTADO_INT_LEVANTAMIENTO=ESTADO_INT_LEVANTAMIENTO.COD_ESTADO_INT_LEVANTAMIENTO
            AND SOLICITUDES_LEVANTAMIENTO.COD_ESTADO_RESP_LEVANTAMIENTO=ESTADO_RESP_LEVANTAMIENTO.COD_ESTADO_RESP_LEVANTAMIENTO(+)
            AND SOLICITUDES_LEVANTAMIENTO.COD_TIPO_DOCUMENTACION=TIPO_DOCUMENTACION.COD_TIPO_DOCUMENTACION
            AND PETICIONES.COD_ESTADO_INT_PETICION=ESTADO_INT_PETICION.COD_ESTADO_INT_PETICION
            AND PETICIONES.COD_ESTADO_PRIMARIO_PETICION=ESTADO_PRIMARIO_PETICION.COD_ESTADO_PRIMARIO_PETICION
            AND PETICIONES.COD_ESTADO_PRIMARIO_RESP=ESTADO_PRIMARIO_RESP.COD_ESTADO_PRIMARIO_RESP(+)
            AND PETICIONES.COD_ESTADO_SECUNDARIO_RESP=ESTADO_SECUNDARIO_RESP.COD_ESTADO_SECUNDARIO_RESP(+)
            UNION
            SELECT PETICIONES.COD_CONTROL_FICHERO,PETICIONES.COD_PETICION,DES_ESTADO_INT_PETICION,PETICIONES.COD_ESTADO_PRIMARIO_PETICION || '-' || DES_ESTADO_PRIMARIO_PETICION,ESTADO_SECUNDARIO_PETICION,PETICIONES.COD_ESTADO_PRIMARIO_RESP || '-' || DES_ESTADO_PRIMARIO_RESP,PETICIONES.COD_ESTADO_SECUNDARIO_RESP || '-' || DES_ESTADO_SECUNDARIO_RESP,
            'EJECUCION' TS,DES_ESTADO_INT_EJECUCION,ESTADO_RESP_EJECUCION.COD_ESTADO_RESP_EJECUCION || '-' || DES_ESTADO_RESP_EJECUCION,ENTIDADES_ORDENANTES.DES_ENTIDAD,
            DES_TIPO_DOCUMENTACION,DOCUMENTACION,NOMBRE_COMPLETO_TITULAR,
            SOLICITUDES_EJECUCION.COD_SOLICITUD_EJECUCION,
            SOLICITUDES_EJECUCION.IMPORTE_SOLICITUD,
            SOLICITUDES_EJECUCION.IMPORTE_RESPUESTA,
            EMBARGO.FECHA_GENERACION
            FROM SOLICITUDES_EJECUCION,
            PETICIONES ,
            EMBARGO,
            TRABAS ,
            ENTIDADES_ORDENANTES,
            ESTADO_INT_EJECUCION,
            ESTADO_RESP_EJECUCION,
            TIPO_DOCUMENTACION,
            ESTADO_INT_PETICION,
            ESTADO_PRIMARIO_PETICION,
            ESTADO_PRIMARIO_RESP,
            ESTADO_SECUNDARIO_RESP
            WHERE PETICIONES.COD_PETICION    =SOLICITUDES_EJECUCION.COD_PETICION
            AND EMBARGO.COD_EMBARGO          =TRABAS.COD_EMBARGO
            AND TRABAS.COD_TRABA             =SOLICITUDES_EJECUCION.COD_TRABA
            AND EMBARGO.COD_ENTIDAD_ORDENANTE=ENTIDADES_ORDENANTES.COD_ENTIDAD_ORDENANTE
            AND SOLICITUDES_EJECUCION.COD_ESTADO_INT_EJECUCION=ESTADO_INT_EJECUCION.COD_ESTADO_INT_EJECUCION
            AND SOLICITUDES_EJECUCION.COD_ESTADO_RESP_EJECUCION=ESTADO_RESP_EJECUCION.COD_ESTADO_RESP_EJECUCION(+)
            AND SOLICITUDES_EJECUCION.COD_TIPO_DOCUMENTACION=TIPO_DOCUMENTACION.COD_TIPO_DOCUMENTACION
            AND PETICIONES.COD_ESTADO_INT_PETICION=ESTADO_INT_PETICION.COD_ESTADO_INT_PETICION
            AND PETICIONES.COD_ESTADO_PRIMARIO_PETICION=ESTADO_PRIMARIO_PETICION.COD_ESTADO_PRIMARIO_PETICION
            AND PETICIONES.COD_ESTADO_PRIMARIO_RESP=ESTADO_PRIMARIO_RESP.COD_ESTADO_PRIMARIO_RESP(+)
            AND PETICIONES.COD_ESTADO_SECUNDARIO_RESP=ESTADO_SECUNDARIO_RESP.COD_ESTADO_SECUNDARIO_RESP(+)</createView>
    </changeSet>

    <changeSet author="aniol.massana (generated)" id="initial-cgpj-cierra-semaforo">
        <createProcedure procedureName="CIERRA_SEMAFORO"><![CDATA[
CREATE OR REPLACE FUNCTION CIERRA_SEMAFORO(
      usuario                IN VARCHAR2,
      nombre_maquina         IN VARCHAR2,
      maximo_minutos_proceso IN NUMBER)
    RETURN NUMBER
  IS
    PRAGMA AUTONOMOUS_TRANSACTION;
    cFechaSemaforo VARCHAR2(20);
    FechaSemaforo DATE;
    NumeroSemaforos  NUMBER;
    CreaSemaforo     BOOLEAN;
    v_otro_corriendo BOOLEAN;
    v_sid            NUMBER;
  BEGIN
    --Recordar dar permisos al usuario EMBARGOS2 de select sobre la tabla v$session: GRANT SELECT ON v$session TO EMBARGOS2
    --Primero de todo verificamos que ningún otro usuario ha lanzado esta función si es así le echamos
    v_sid           := NULL;
    v_otro_corriendo:=true;
    BEGIN
      SELECT sid
      INTO v_sid
      FROM v$session
      WHERE module = 'CIERRA_SEMAFORO'
      AND rownum   = 1;
    EXCEPTION
    WHEN no_data_found THEN
      v_otro_corriendo := false;
    END;
    IF v_otro_corriendo THEN
      DBMS_OUTPUT.PUT_LINE('Ya se está ejecutando este proceso');
      RETURN 0;
    END IF;
    DBMS_APPLICATION_INFO.SET_MODULE('CIERRA_SEMAFORO', 'EJECUTANDO_CIERRA_SEMAFORO');
    --DBMS_LOCK.sleep(60); --GRANT EXECUTE ON DBMS_LOCK TO EMBARGOS2
    CreaSemaforo :=false;
    BEGIN
      SELECT DD_MM_AAAA_HH_MM_SS(FECHA)
      INTO cFechaSemaforo
      FROM SEMAFORO
      WHERE ROWNUM=1;
    EXCEPTION
    WHEN NO_DATA_FOUND THEN
      CreaSemaforo:=true;
    END;
    --Verificamos que el semáforo no lleva mucho tiempo cerrado
    FechaSemaforo:=TO_DATE(cFechaSemaforo,'dd/MM/yyyy hh24:mi:ss');
    IF ((SysDate                 -fechasemaforo)*24*60)>maximo_minutos_proceso THEN
      CreaSemaforo                                    :=true;
    END IF;
    IF CreaSemaforo THEN
      DELETE FROM SEMAFORO;
      INSERT
      INTO SEMAFORO
        (
          FECHA,
          USUARIO,
          MAQUINA
        )
        VALUES
        (
          TO_NUMBER(TO_CHAR(SysDate,'yyyyMMddhh24miss')),
          usuario,
          nombre_maquina
        );
      COMMIT;
      DBMS_APPLICATION_INFO.SET_MODULE('', '');
      RETURN 1;
    ELSE
      DBMS_APPLICATION_INFO.SET_MODULE('', '');
      RETURN 0;
    END IF;
END;
]]>
        </createProcedure>
        <rollback>
            <sql>DROP FUNCTION CIERRA_SEMAFORO</sql>
        </rollback>
    </changeSet>

    <changeSet author="aniol.massana (generated)" id="initial-cgpj-ddmmaa">
        <createProcedure procedureName="DD_MM_AAAA"><![CDATA[
CREATE OR REPLACE FUNCTION "DD_MM_AAAA"   (Fecha Number) RETURN VARCHAR2 is
--esta funcion devuelve con formato dd/mm/aaaa
--una fecha pasada con formato aaaammdd

    DIA VARCHAR2(2);
    MES VARCHAR2(2);
   ANIO VARCHAR2(4);
   RESULTADO VARCHAR2(18);
BEGIN
    RESULTADO:=TO_CHAR(Fecha);
    DIA:=SUBSTR(RESULTADO,7,2);
    MES:=SUBSTR(RESULTADO,5,2);
    ANIO:=SUBSTR(RESULTADO,1,4);

   RESULTADO:=CONCAT(DIA,'/');
   RESULTADO:=CONCAT(RESULTADO,MES);
   RESULTADO:=CONCAT(RESULTADO,'/');
   RESULTADO:=CONCAT(RESULTADO,ANIO);

 return(RESULTADO);


end;

]]>
        </createProcedure>
        <rollback>
            <sql>DROP FUNCTION DD_MM_AAAA</sql>
        </rollback>
    </changeSet>

    <changeSet author="aniol.massana (generated)" id="initial-cgpj-ddmmaahhmmss">
        <createProcedure procedureName="DD_MM_AAAA_HH_MM_SS"><![CDATA[
CREATE OR REPLACE FUNCTION "DD_MM_AAAA_HH_MM_SS"    (Fecha Number) RETURN VARCHAR2 is
--esta funcion devuelve con formato dd/mm/aaaa hh:mm:ss
--una fecha pasada con formato aaaammddhhmmss

    DIA VARCHAR2(2);
    MES VARCHAR2(2);
   ANIO VARCHAR2(4);
   HORA VARCHAR2(2);
   MINUTO VARCHAR2(2);
   SEGUNDO VARCHAR2(2);
   RESULTADO VARCHAR2(19);
BEGIN
    RESULTADO:=TO_CHAR(Fecha);

    DIA:=SUBSTR(RESULTADO,7,2);
    MES:=SUBSTR(RESULTADO,5,2);
    ANIO:=SUBSTR(RESULTADO,1,4);
 	  HORA:=SUBSTR(RESULTADO,9,2);
 	  MINUTO:=SUBSTR(RESULTADO,11,2);
 	  SEGUNDO:=SUBSTR(RESULTADO,13,2);
   RESULTADO:=CONCAT(DIA,'/');
   RESULTADO:=CONCAT(RESULTADO,MES);
   RESULTADO:=CONCAT(RESULTADO,'/');
   RESULTADO:=CONCAT(RESULTADO,ANIO);
   RESULTADO:=CONCAT(RESULTADO,' ');
   RESULTADO:=CONCAT(RESULTADO,HORA);
   RESULTADO:=CONCAT(RESULTADO,':');
   RESULTADO:=CONCAT(RESULTADO,MINUTO);
   RESULTADO:=CONCAT(RESULTADO,':');
   RESULTADO:=CONCAT(RESULTADO,SEGUNDO);
 return(RESULTADO);


end;

]]>
        </createProcedure>
        <rollback>
            <sql>DROP FUNCTION DD_MM_AAAA_HH_MM_SS</sql>
        </rollback>
    </changeSet>

    <changeSet author="aniol.massana (generated)" id="initial-cgpj-formato-ccc">
        <createProcedure procedureName="FORMATO_CCC"><![CDATA[
CREATE OR REPLACE FUNCTION "FORMATO_CCC" (cCuentaFmtCommerz Varchar2, cTerminacion Varchar2) RETURN VARCHAR2 is

cCuentaFmtCCC VARCHAR2(23);
BEGIN

  IF SUBSTR(cCuentaFmtCommerz,1,3) = '170' THEN
    cCuentaFmtCCC := '0159 0001 ** ' || SUBSTR(cCuentaFmtCommerz,4,7) || SUBSTR(cTerminacion,2,3);
  ELSE
    cCuentaFmtCCC := '0159 0002 ** ' || SUBSTR(cCuentaFmtCommerz,4,7) || SUBSTR(cTerminacion,2,3);
  END IF;

  return(cCuentaFmtCCC);

end;

]]>
        </createProcedure>
        <rollback>
            <sql>DROP FUNCTION FORMATO_CCC</sql>
        </rollback>
    </changeSet>
</databaseChangeLog>
